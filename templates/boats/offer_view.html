{% extends 'base.html' %}

{% block title %}–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ #{{ offer.uuid|slice:":8" }} - BoatRental{% endblock %}

{% block content %}
<!-- Header -->
<div class="bg-gradient-to-r from-primary to-secondary text-white py-12">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto text-center">
            <h1 class="text-3xl md:text-4xl font-bold mb-4">
                üéâ –í–∞—à–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
            </h1>
            <p class="text-lg opacity-90">
                –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–æ–±—Ä–∞–Ω–Ω—ã–µ —è—Ö—Ç—ã –¥–ª—è –≤–∞—à–µ–≥–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è
            </p>
        </div>
    </div>
</div>

<!-- Content -->
<div class="container mx-auto px-4 py-8" x-data>
    <div class="max-w-6xl mx-auto">
        
        <!-- Offer Info -->
        <div class="card bg-base-100 shadow-lg mb-8">
            <div class="card-body">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                        <h2 class="text-2xl font-bold">–î–µ—Ç–∞–ª–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
                        <div class="flex flex-wrap gap-4 mt-2 text-sm">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-calendar text-primary"></i>
                                <span>{{ offer.check_in|date:"d.m.Y" }} - {{ offer.check_out|date:"d.m.Y" }}</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-users text-primary"></i>
                                <span>{{ offer.guests }} –≥–æ—Å—Ç–µ–π</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-map-marker-alt text-primary"></i>
                                <span>{{ offer.destination }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats stats-vertical lg:stats-horizontal shadow">
                        <div class="stat">
                            <div class="stat-title text-xs">ID –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</div>
                            <div class="stat-value text-base">{{ offer.uuid|slice:":8" }}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Boats -->
        <div class="space-y-6">
                {% for boat in offer.boats.all %}
            <div class="card lg:card-side bg-base-100 shadow-lg card-hover">
                <!-- Image -->
                <figure class="lg:w-2/5">
                    {% if boat.primary_image %}
                    <img 
                        src="{{ boat.primary_image|cdn_url }}" 
                        alt="{{ boat.name }}"
                        class="w-full h-64 lg:h-full object-cover"
                    />
                    {% else %}
                    <div class="w-full h-64 lg:h-full bg-base-200 flex items-center justify-center">
                        <i class="fas fa-ship text-6xl opacity-20"></i>
                    </div>
                    {% endif %}
                </figure>
                
                <div class="card-body lg:w-3/5">
                    <!-- Category Badge -->
                    <div class="badge badge-primary mb-2">
                        {% if boat.boat_type == 'sailing-yacht' %}‚õµ –ü–∞—Ä—É—Å–Ω–∞—è —è—Ö—Ç–∞
                        {% elif boat.boat_type == 'catamaran' %}üö§ –ö–∞—Ç–∞–º–∞—Ä–∞–Ω
                        {% elif boat.boat_type == 'motor-yacht' %}üõ•Ô∏è –ú–æ—Ç–æ—Ä–Ω–∞—è —è—Ö—Ç–∞
                        {% else %}‚õµ –õ–æ–¥–∫–∞
                        {% endif %}
                    </div>
                    
                    <h2 class="card-title text-2xl">{{ boat.name }}</h2>
                    
                    <p class="text-sm opacity-70 flex items-center gap-1 mb-4">
                        <i class="fas fa-map-marker-alt"></i>
                        {{ boat.marina }}, {{ boat.country }}
                    </p>
                    
                    <!-- Stats -->
                    <div class="grid grid-cols-4 gap-4 mb-4">
                        {% if boat.length %}
                        <div class="text-center">
                            <div class="text-2xl font-bold text-primary">{{ boat.length }}m</div>
                            <div class="text-xs opacity-60">–î–ª–∏–Ω–∞</div>
                        </div>
                        {% endif %}
                        
                        {% if boat.cabins %}
                        <div class="text-center">
                            <div class="text-2xl font-bold text-primary">{{ boat.cabins }}</div>
                            <div class="text-xs opacity-60">–ö–∞—é—Ç</div>
                        </div>
                        {% endif %}
                        
                        {% if boat.berths %}
                        <div class="text-center">
                            <div class="text-2xl font-bold text-primary">{{ boat.berths }}</div>
                            <div class="text-xs opacity-60">–ú–µ—Å—Ç</div>
                        </div>
                        {% endif %}
                        
                        {% if boat.year %}
                        <div class="text-center">
                            <div class="text-2xl font-bold text-primary">{{ boat.year }}</div>
                            <div class="text-xs opacity-60">–ì–æ–¥</div>
                        </div>
                        {% endif %}
                    </div>
                    
                    <!-- Equipment -->
                    {% if boat.equipment %}
                    <div class="mb-4">
                        <h3 class="font-semibold mb-2 flex items-center gap-2">
                            <i class="fas fa-list text-primary"></i>
                            –û—Å–Ω–æ–≤–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ:
                        </h3>
                        <div class="flex flex-wrap gap-2">
                            {% for item in boat.equipment|slice:":6" %}
                            <span class="badge badge-outline badge-sm">{{ item }}</span>
                            {% endfor %}
                            {% if boat.equipment|length > 6 %}
                            <span class="badge badge-outline badge-sm">+{{ boat.equipment|length|add:"-6" }}</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                    
                    <!-- Price and Action -->
                    <div class="card-actions justify-between items-center mt-4 pt-4 border-t">
                        <div>
                            <div class="text-3xl font-bold text-primary">‚Ç¨{{ boat.price }}</div>
                            <div class="text-xs opacity-60">–∑–∞ –Ω–µ–¥–µ–ª—é</div>
                        </div>
                        <button class="btn btn-primary" @click="selectBoat('{{ boat.id }}')">
                            <i class="fas fa-check mr-2"></i>
                            –í—ã–±—Ä–∞—Ç—å —ç—Ç—É —è—Ö—Ç—É
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Total -->
        <div class="card bg-primary text-primary-content shadow-lg mt-8">
            <div class="card-body">
                <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                    <div>
                        <h3 class="text-2xl font-bold">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</h3>
                        <p class="opacity-90">–ó–∞ –ø–µ—Ä–∏–æ–¥ {{ offer.nights }} –Ω–æ—á–µ–π</p>
                    </div>
                    <div class="text-right">
                        <div class="text-4xl font-bold">‚Ç¨{{ offer.total_price }}</div>
                        <div class="text-sm opacity-90">–≤—Å–µ –≤–∫–ª—é—á–µ–Ω–æ</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Contact -->
        <div class="card bg-base-100 shadow-lg mt-8">
            <div class="card-body text-center">
                <h3 class="text-2xl font-bold mb-4">–ì–æ—Ç–æ–≤—ã –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å?</h3>
                <p class="mb-6">–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</p>
                <div class="flex flex-col md:flex-row gap-4 justify-center">
                    <a href="tel:+1234567890" class="btn btn-primary btn-lg">
                        <i class="fas fa-phone mr-2"></i>
                        –ü–æ–∑–≤–æ–Ω–∏—Ç—å
                    </a>
                    <a href="mailto:info@boatrental.com?subject=–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ {{ offer.uuid|slice:":8" }}" class="btn btn-outline btn-lg">
                        <i class="fas fa-envelope mr-2"></i>
                        –ù–∞–ø–∏—Å–∞—Ç—å email
                    </a>
                </div>
                
                <div class="divider">–∏–ª–∏</div>
                
                <button class="btn btn-success btn-lg" @click="bookNow()">
                    <i class="fas fa-check-circle mr-2"></i>
                    –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–Ω–ª–∞–π–Ω
                </button>
            </div>
        </div>
        
        <!-- Share -->
        <div class="text-center mt-8">
            <p class="text-sm opacity-70 mb-2">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º:</p>
            <div class="flex gap-2 justify-center">
                <button class="btn btn-circle btn-sm btn-ghost" @click="shareOffer('whatsapp')">
                    <i class="fab fa-whatsapp text-xl"></i>
                </button>
                <button class="btn btn-circle btn-sm btn-ghost" @click="shareOffer('telegram')">
                    <i class="fab fa-telegram text-xl"></i>
                </button>
                <button class="btn btn-circle btn-sm btn-ghost" @click="shareOffer('email')">
                    <i class="fas fa-envelope text-xl"></i>
                </button>
                <button class="btn btn-circle btn-sm btn-ghost" @click="copyLink()">
                    <i class="fas fa-link text-xl"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
function selectBoat(boatId) {
    alert('–í—ã –≤—ã–±—Ä–∞–ª–∏ —è—Ö—Ç—É #' + boatId);
    // TODO: Implement boat selection
}

function bookNow() {
    alert('–ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è');
    // TODO: Implement booking flow
}

function shareOffer(platform) {
    const url = window.location.href;
    const text = '–ü–æ—Å–º–æ—Ç—Ä–∏ —ç—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ –∞—Ä–µ–Ω–¥–µ —è—Ö—Ç—ã!';
    
    switch(platform) {
        case 'whatsapp':
            window.open(`https://wa.me/?text=${encodeURIComponent(text + ' ' + url)}`);
            break;
        case 'telegram':
            window.open(`https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`);
            break;
        case 'email':
            window.location.href = `mailto:?subject=–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ –∞—Ä–µ–Ω–¥–µ —è—Ö—Ç—ã&body=${encodeURIComponent(text + '\n\n' + url)}`;
            break;
    }
}

function copyLink() {
    navigator.clipboard.writeText(window.location.href).then(() => {
        alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!');
    });
}
</script>
{% endblock %}
